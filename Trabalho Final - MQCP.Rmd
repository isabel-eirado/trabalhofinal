---
title: "Mudanças constitucionais estaduais dos EUA: Revisitando a base de dados de Clouse"
author: "Amanda Lopes; Ana Vaz; Bárbara Maia; Isabel Eirado"
date: "Dezembro/2020"
output: html_document
---

```{r setup, include=FALSE, echo=FALSE, warning=FALSE, message = FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r ativando pacotes, echo=FALSE, message=FALSE, warning=FALSE, message = FALSE, paged.print=FALSE}
#ativando os pacotes a serem usados
library(readxl)
library(ggplot2)
library(tidyr)
library(dplyr)
library(rmarkdown)
library (infer)
library(tidyverse)
library(tibble)
library(ggpubr)
library(devtools)
devtools::install_github("cardiomoon/webr")
library(webr)
library(forcats)
library(leaflet)
library(tigris)
library(sf)
```


>*Laws and institutions must go hand in hand with
the progress of the human mind. As that becomes more developed, more enlightened,
as new discoveries are made, new truths disclosed, and manners and opinions change
with the circumstances, institutions must advance also, and keep pace with the times.” 
- Thomas Jefferson, 1816*

# Resumo ####

O objetivo deste trabalho é revistar o Banco de Dados **"US State Constitutions Dataset"**, criado por Julia Gervaise-Rubicam Clouse (CLOUSE, 2019), e propor um novo olhar e análises aos dados ali apresentados. O dataset converte textos constitucionais (históricos e atuais) dos Estados dos EUA para dados quantificáveis utilizando-se da categorização destes textos. A intenção do trabalho de Clouse (2019) é analisar a evolução das ideias e prioridades políticas nos 50 estados do país, em que pese a mudança das Constituições Estaduais no decorrer do tempo. Utilizando-se dessa base de dados, este trabalho propõe analisar as mudanças constitucionais a partir do número de palavras totais dos textos constitucionais e das regras formais que abarcam os três poderes - Executivo, Legislativo e Judiciário. Conclui-se que há um campo fértil para comparação entre as Constituições Estaduais e se observam tendências gerais nos tópicos de foco dos Estados. O teste de hipótese realizado demonstra que as Constituições atuais são maiores e mais abrangentes que as Constituições históricas, sendo possível verificar algumas relações entre as variáveis. Por fim, pontua-se que este tipo de pesquisa se beneficiaria de uma análise qualitativa em profundidade, a fim de melhor avaliar as categorias analíticas, de modo a viabilizar conclusões combinadas entre dados qualitativos e quantitativos.

<style>
body {
text-align: justify}
</style>

# Introdução ####

Este trabalho tem como objeto a mudança constitucional no federalismo estadunidense. O objetivo principal é analisar a evolução de ideias e prioridades políticas nos 50 Estados estadunidenses a partir das mudanças constitucionais.
Deste, surgem como objetivos específicos: 
1. Observar mudanças constitucionais a partir das variações das palavras totais das Constituições;
2. Verificar a tendência a mudança constitucional a partir do número de Constituições implementadas ao longo do tempo e;
3. Observar, a partir de um índice, a mudança proporcional entre os três poderes nas constituições estaduais.

- Contextualização

A organização do federalismo estadunidense dá às unidades subnacionais considerado potencial para inovações constitucionais e experimentação política ("espaço constitucional"), inclusive em comparação à maior parte de outras federações (BURGESS, TARR & MARKO, 2004).Essa possibilidade de mudança foi utilizada pelos estados de maneira frequente - seja pela substituição completa ou pelo emendamento das Cartas vigentes. Diferentemente do que ocorre com a Constituição Federal, emendas e mudanças nas Constituições Estaduais são relativamente fáceis, além de congregarem uma gama de atores, tendo um caráter popular mais visível, dado que são propostas ou votadas pela população (ACIR, 1989). 

Além disto, Woodward-Burns (2007) irá apontar que é justamente a revisão constitucional estadual que resolve as controvérsias constitucionais nacionais, evitando emendas nesta e atuando na resulução de conflitos, em escala nacional, entre os poderes. De fato, enquanto em nível federal, somente uma Constituição foi ratificada, com 27 emendas, os estados Americanos tem uma larga produção constitucional, com 153 constituições adotadas[^1], sendo que o número de emendas, até 2013, chegava a quase 10.000 (TARR, 2016).

[^1]:Aqui, utilizamos a contagem feita por Clouse (2019). É importante apontar que sua contagem, conforme será explicitados nas notas metodológicas, diverge da contagem de outros autores, como o Book of States (2012), que aponta para a exitência de 145.

O que está por trás da frequência das alterações, e é particularmente o objeto de interesse aqui, são os tipos de mudanças propostos pelas novas Constituições. As Constituições Estaduais tendem a ser mais longas que a Constituição Federal (CF) por serem mais detalhadas no que tange as relações cotidianas entre o governo e a população dos estados (ACIR, 1989). Além disso, boa parte das Constituições Estaduais irá abordar tópicos não abordados na CF, como Governo Local e Educação (TARR, 2016). Mas, em grande medida, representam escolhas políticas dos próprios estados, as necessidades ali encontradas e filosofias de governo próprias (ACIR, 1989).

Assim, se por um lado se entende que as Constituições Estaduais completam e balanceiam a Constituição Federal, e, portanto, são essenciais para o funcionamento do sistema federativo estadunidense, por outro a frequência das mudanças das Constituições representa um lugar fértil para entender:
a) de que forma as ideias e prioridades políticas vêm evoluindo nos 50 estados;
b) de que forma os estados vêm se adaptando às necessidades de novas ações políticas, sociais, domésticas e externas.

De modo, geral, portanto, observa-se que a importância da compreensão das Constituições subnacionais está justamente no fato de que a maior parte das revisões constitucionais nos EUA acontecem em nível estadual. Para além deste fato, reforça-se que a compreensão das instituicições estadunidenses e do sistema federalista do país se apoiam, largamente, também neste nível.

Assim, questiona-se: é possível observar padrões de mudança nas Constituições Estaduais dos 50 estados americanos ao longo do tempo?

<style>
body {
text-align: justify}
</style>

# Método ####

O US State Constitutions Dataset é composto por 203 Constituições Estaduais que abrangem o período de 1776 a 2017, dos quais 153 são Constituições Históricas somadas às 50 Constituições Atuais. Dentre as Constituições Históricas, Clouse (2019) incluiu Constituições Estaduais não-tradicionais, além de oito Constituções que foram adotadas ainda sob o Estado Confederado da América.
 
A partir disso, Clouse (2019) estabeleceu 32 categorias: preamble, state boundaries, declaration of rights, religion, private property, discrimination, suffrage & elections, people's initiative, representation & apportionment, legislative, executive, judicial, militia, general operations, education, taxation & finance, business & corporations, railroads & canals, banking, social regulation, public goods, agriculture, natural resources & environment, entitlements, public institutions, state lands, state powers, local government, federal government, amendment process, schedule, postscript.

```{r importando os dados, echo=FALSE, message = FALSE}
state_const <- read_excel("US-State_Constitutions_Dataset_1776-2017.xlsx")
States_and_Abbreviations <- read_excel("States and Abbreviations.xlsx")

state_const <-  state_const %>%
  left_join(States_and_Abbreviations, state_const, by = "state") 
```

Abaixo é possível visualizar o banco de dados elaborado por ela:

```{r banco de dados, echo=FALSE, paged.print=TRUE, message = FALSE}
state_const %>% #selecionando o dataframe
  arrange(state) %>% #ordem alfabética por estado
  paged_table (state_const) #imprimindo a tabela 
```

Neste trabalho focaremos nas variáveis:
1. state - nome dos estados da Federação.
2. abbreviation - abreviação dos nomes dos Estados.
3. statehood - informa o ano em que o estado passou a integrar a Federação dos Estados Unidos da América.
4. constitution_year - informa o ano da Constituição.
5. current_constitution - informa a Constituição vigente (1) e as Constituições históricas (0).
6. total_words - informa o número total de palavras da Constituição.
7. legislative -  descreve as funções, procedimentos, poderes e limitações do Poder Legislativo
8. executive - descreve as funções, estrutura, poderes e limitações do Poder Executivo
9. judicial - descreve as funções e poderes dos sistemas de tribunais estaduais e dos funcionários do Poder Judiciário

A literatura demonstra que, ao longo do tempo, as Constituições tem se alargado. De acordo com Tarr (2006), a história das Constituições Estaduais dos EUA consiste na mudança constitucional. A expansão e evolução das Constituições já foi alvo de muito interesse por pesquisadores (DEALEY, 2009; BRYCE, 1995), assim como a expansão em termos de número de palavras, isto é, seu tamanho (LUCE, 2009; DE GRAZIA, 1954; STURM, 1982). A novidade da base trazida por Clouse (2019) é a transformação dos textos constitucionais em variáveis quantitativas comparáveis. Assim, parte-se da premissa que as Constituições Estaduais mudam ao longo tempo, se expandindo (fato medido pela quantidade de palavras). Dado que a expansão vem ocorrendo ao longo do tempo, a ideia é verificar se as atuais constituições se expandiram mais do que a média das constituições históricas. Com base nisso, pretende-se verificar se:

**H0**: *A variação do número de palavras permance a mesma ao longo das mudanças constitucionais*.

**H1**: *Há maior variação no número de palavras das Constituições Estaduais correntes, em relação às Constituições anteriores.*

Para isso, foi utilizado o teste-t, que objetiva comparar o tamanho (em termos de número de palavras) das Constituições Atuais e a média do tamanho das Constituições Históricas. Assim, operacionalizou-se como Constituições Históricas a média do número total de palavras de todas as Constituições de cada Estado, excluída a Constituição atual, enquanto as Constituições Atuais foram operacionalizadas a partir do número de palavras das Constituições Estaduais atuais.

Diante dos critérios de reproducibilidade da pesquisa científica, disponibilizamos os códigos usados para este trabalho no github - https://github.com/isabel-eirado/trabalhofinal.git

# Visualização e Análise de dados ####

- Diante do objetivo de compreender as mudanças constitucionais, esta seção será dividida em 3 partes:

1. Análise das mudanças constitucionais pelo número total de palavras nas constituições
2. Análise das mudanças constitucionais pelo número de constituições promulgadas
3. Análise das mudanças constitucionais a partir do Índice de Mudança Proporcional dos Poderes

## Análise das mudanças constitucionais pelo número total de palavras nas constituições ####

Para essa seção, apresentamos três gráficos e um mapa interativo que revisitam os achados de Clouse (2019). O mapa interativo permite a visualização dos dados individuais de cada estado, além de apresentar - a partir da variação nas cores de preenchimento - o número total de palavras dispostas em cada Constituição. Outra forma de visualização destes dados está disposta no Gráfico 1, que apresenta o número de palavras nas Constituições estatais vigentes a partir de um gráfico de pontos. Na análise quantitativa sobre as mudanças constitucionais, o Gráfico 2 acompanha a análise anterior, medindo a variação entre as médias a partir do desvio padrão. Por fim, o Gráfico 3 busca uma correlação entre os anos de mudanças constitucionais e o número de palavras em cada texto constitucional. 



### Mapa interativo com informações gerais sobre as Constituições Estaduais dos Estados Unidos ####

O mapa, a seguir, apresenta graficamente uma escala do número total de palavras das Constituições atuais e, em específico, informações gerais sobre cada Estado: nome, ano de promulgação da Constituição Estadual corrente, total de palavras da Constituição vigente e a quantidade de Constituições que já passaram pelo Estado. 


```{r mapa interativo, warning=FALSE, include=FALSE, echo=FALSE, message = FALSE}

# A. Preparando o data.frame "state_const"
state_const_dados <-  state_const %>%
  add_count(state) %>% 
  # 1. Foi adicionada uma coluna com o número total de constituições por estado
  filter(current_constitution == 1) %>% 
  # 2. Para viabilizar a visualização no mapa foram filtradas apenas as observações que constam as constituições
  mutate(sigla = state.abb) 
  # 3. Foi adicionada uma coluna com as siglas de cada estado

# B. Preparando o data.frame com as informações espaciais dos EUA
states <- states(cb=T)

# C. Visto que o data.frame "states" tem 56 observações, enquanto "state_const" tem 50, serão eliminados os casos sobressalentes do data.frame "states"
states <- states %>%
  filter(NAME!="American Samoa" 
         & NAME!="Commonwealth of the Northern Mariana Islands" 
         & NAME!="District of Columbia" 
         & NAME!="Guam" 
         & NAME!="Puerto Rico" 
         & NAME!="United States Virgin Islands")

```


```{r mapa interativo 2, echo=FALSE, message=FALSE, warning=FALSE}

# D. Com os data.frames preparados, eles serão condensados usando left_join()
mapa_interativo <- left_join(states, state_const_dados, by = c("NAME" = "state"))

# E. Com o data.frame pronto, é hora de preparar o mapa interativo

# 1. Foi criado um vetor numérico para definir as escala correspondente ao número de palavras das constituições estaduais
bins <- c(5000, 10000, 20000, 50000, 100000, Inf)

# 2. A partir do passo anterior, criou-se uma função com "colorBin" para preencher a área do mapa de acordo com o objeto que se deseja verificar (total_words)
pal <- colorBin("YlOrRd", domain = mapa_interativo$total_words, bins = bins)

# 3. Por fim, criou-se um novo data.frame com o modelo de inserção dos rótulos no mapa
labels <- sprintf("<strong>%s</strong><br/> CE atual: %g<br/>nº palavras: %g<br/>CEs anteriores: %g", mapa_interativo$NAME, mapa_interativo$constitution_year, mapa_interativo$total_words, mapa_interativo$n) %>% lapply(htmltools::HTML)

# F. A plotagem do mapa interativo
mapa_interativo %>%
  leaflet() %>%
  # 1. Função leaflet() para a criação de mapas interativos
  setView(-96, 37.8, 4) %>%
  # 2. SetView() estabelece o ângulo de visualização do mapa
  addTiles() %>%
  # 3. Adiciona uma camada de blocos ao mapa
  addPolygons(fillColor =~pal(total_words),
  weight = 2,
  opacity = 0.5,
  color = "white",
  dashArray = "3",
  fillOpacity = 0.7,
  highlight = highlightOptions(
    weight = 5,
    color = "#555",
    dashArray = "",
    fillOpacity = 0.7,
    bringToFront = TRUE),
  label = labels,
  labelOptions = labelOptions(
    style = list("font-weight" = "normal", padding = "3px 8px"),
    textsize = "10px",
    direction = "auto")) %>%
  # 4. Detalhamento do layout do mapa
  addLegend(pal = pal, values = ~total_words, opacity = 0.7, title = "Número total de palavras das Constituições atuais", position = "bottomright")
# 5. Adicionar uma cor de legenda ao mapa

# Material de apoio: <https://rstudio.github.io/leaflet/choropleths.html>.

```



```{r, echo=FALSE, message = FALSE}
#Manipulando os dados: selecionando e filtrando as informações de interesse a partir da base de dados, e, em seguida, as colunas de interesse usando o pacote dplyr.
state_const_current_total_words <- state_const %>% 
add_count(state) %>% #criando coluna que informe o total de constituições de cada estado
select(state, constitution_year, current_constitution, total_words, state_number, abbreviation) %>% #selecionando as variaveis de interesse - estado, ano da Constituição, Constituição atual e total de palavras
  filter(current_constitution == 1) #filtrando apenas as constituições vigentes
```


### Gráfico 1 - Total de palavras das constituições vigentes por estado ####
A fim de identificar a diferença do número de palavras das constituições vigentes em cada Estado, criamos um gráfico de pontos (scatter chart). A partir das variáveis em foco ("total de palavras" e "estado") é possível evidenciar a diferença entre o número de palavras nas constituições vigentes em cada estado.
```{r paged.print=TRUE, echo=FALSE, warning=FALSE, message = FALSE}
options(scipen = 999)
state_const_current_total_words %>% 
  mutate(abbreviation=fct_reorder(abbreviation, total_words)) %>%
  ggplot(aes(x=abbreviation, y= total_words)) + #definindo os dados a serem projetados nos eixos x e y
  geom_point(color="red", size=1, fill="red") +#definindo a geometria scatter com cor de contorno e preenchimento vermelhas e o tamanho do preenchimento
  theme_minimal() +  #definindo o tema minimo com linhas para facilitar a identificação de cada ponto
  theme(axis.text.x = element_text(angle=90, hjust=1)) + #definindo a posição vertical para o eixo x
  labs(x = "Estado",
       y = "Total de palavras") #nomeando os eixos
```





A partir do gráfico, percebe-se que:
1. O Alabama é um outlier na medida em que dispõe de um total de palavras maior do que qualquer outro estado. A constituição do Alabama tem 339.576 palavras, puxando a média de palavras para cima. O Texas tem a segunda maior Constituição em termos de número de palavras, mas ainda assim, a diferença de palavras entre as duas constituições é de 252.495. Por isso, para fins estatísticos, o Alabama foi excluído de algumas das análises posteriores. 
2. A Constituição de Vermont é a menor em termos de número de palavras 
3. Observa-se, com exceção do Alabama, que os valores totais de palavras dos textos constituientes tem uma variação menor. A diferença entre o Texas, segundo maior texto constitucional, e Vermont, menor texto constitucional, é de 79.169 palavras. 


### Gráfico 2 - Variação do total de palavras das constituições por estado
O objetivo deste gráfico é observar se o tempo é um fator relevante para gerar mudança no número de palvaras totais das constituições. Sendo assim, mediremos a variação do número de palavras das constituições (a partir do desvio padrão) por estado para, desta forma, poderemos identificar se o total de palavras das constituições de cada estado variou ao longo do tempo ou não. 
  
```{r paged.print=TRUE, echo=FALSE, fig.height=6, fig.width=8, warning=FALSE, message = FALSE}
var_words <- state_const %>%
  group_by(state) %>%
  mutate(dp_total_words = sd(total_words)) %>% #criando coluna com o desvio padrão do total de palavras por estado
  filter(current_constitution==1) %>% #selecionando apenas o desvio padrão do total de palavras das constituições vigentes
  arrange(dp_total_words)

var_words %>%
filter(state != "Alabama") %>% #removendo o alabama por ser um outlier
  ggplot(aes(x = dp_total_words, 
             y =  fct_inorder(abbreviation)))+ #ao definir o mapping no ggplot, as orientações são globais para todos os outros gráficos que virem a seguir
  geom_col(alpha = 0.7, width = .65) + #estabelecendo a transparência das barras e o tamanho delas
  theme_minimal()+ #tema com grades para facilitar a visualização
  labs(x = "Desvio padrão do total de palavras",
       y = "Estado") #nomeando os eixos
  
```



1. O gráfico apresenta os resultados a partir do cálculo do desvio padrão dos valores de palavras totais de todas as constituições de cada estado dos EUA. Aqui, investiga-se de que forma esse conjunto de dados está variando. 
2. A Califórnia é o Estado que apresenta a maior variação em relação a média de palavras totais. Seu valor chega a 123384.56453. 
3. Os estados com o menor valor de desvio padrão (Alaska, Minnesota, Wisconsin, Vermont, Indiana e South Dakota) parecem ser os estados com o menor número de mudanças constitucionais. Essa relação será analisada a frente, a partir do gráfico com o número de mudanças constituicionais por estado. 

### Gráfico 3 - Total de palavras por Constituição
Objetivamos, com esse gráfico, identificar o grau de correlação entre o ano da Constituição e o total de palavras das Constituições, a fim de identificar se há uma mudança constitucional com o aumento de palavras ao longo do tempo.
```{r, echo=FALSE, warning=FALSE, message = FALSE}
state_const %>%
filter(state != "Alabama") %>% #removendo o Alabama para evitar contágio da amostra
ggscatter(x = "total_words",
y = "constitution_year",
add = "reg.line", # Adicionando linha de regressão
conf.int = TRUE,
legend = "bottom") +
stat_cor(aes(), method = "pearson",
         label.x = 25000,
         label.y = 2100) +
  labs(x = "Total de palavras",
       y = "Ano da Constituição") 
```



Na correlação de Pearson acima, o R = 0,61. Há uma correlação moderada entre as observações. Apesar de uma notável proximidade entre os números de palavras nas constituições entre os anos de 1800 e 1900, as mudanças posteriores não apresentam um padrão contínuo de crescimento. As mudanças mais recentes tem valores totais de palavras dispersos entre si. 


### Teste T para verificar as hipóteses ####
O teste-t foi utilizado para comparar o tamanho (em termos de número de palavras) das constituições atuais e a média do tamanho das constituições históricas.

```{r, echo=FALSE, message = FALSE}
# Criando uma coluna com a Média de Palavras das Constituições Estaduais
constituicoes_testehipotese <- state_const %>% 
  select(state, constitution_year, 
  current_constitution, total_words) %>% 
  group_by(state) %>%
  mutate(media_total_words = mean(total_words))
```


```{r, echo=FALSE, message = FALSE}
# Operacionalizando a variável media_antigas
constituicoes_antigas <- constituicoes_testehipotese %>% 
  filter(current_constitution == 0) %>%
  group_by(state) %>%
  mutate(media_total_words = mean(total_words)) %>% 
  select(state, media_total_words) %>% 
  group_by(state, media_total_words) %>%
  summarise(n())

media_antigas <- constituicoes_antigas$media_total_words
```


```{r, echo=FALSE, message = FALSE}
# Operacionalizando a variável valor_novas
constituicoes_novas <- constituicoes_testehipotese %>%
  filter(current_constitution == 1) %>%
  select(state, constitution_year, total_words) 

valor_novas <- constituicoes_novas$total_words
```

```{r message=TRUE, paged.print=TRUE, echo=FALSE, message = FALSE}
# Realizando o teste T
t.test(x=media_antigas, y=valor_novas, paired = TRUE)
```

```{r paged.print=TRUE, echo=FALSE, message = FALSE}
#Gráfico com o teste t
plot(t.test(media_antigas,valor_novas, mu = 0))
```


## Análise das mudanças constitucionais pelo número de constituições promulgadas
Após analisar relações quanto ao número de palavras, seguimos para análise do número de Constituições promulgadas por cada estado dos EUA, identificando o ano da Constituição vigente de cada estado. Neste caso, o Alabama não foi excluído por não afetar os resultados para o propósito desta subseção.

```{r, echo=FALSE, message = FALSE}
#Criando tabela para analisar o total de constituições de cada estado
const_eua_painel <- state_const  %>%
  as_tibble()  %>% #transformando em tibble
  add_count(state) %>% #adicionando uma nova coluna com o número de contagem a partir de um grupo de variaveis 
  select(state, n, constitution_year, current_constitution, statehood, state_number, abbreviation) %>% #selecionando as variaveis para trabalhar
  filter(current_constitution == 1) %>% #filtrando as observações que quero manter
  rename(numero_total_constituicoes = 'n') %>% #renomeando a variavel referente ao numero total de constituições
  mutate(regiao = state.region) %>% #criando outra coluna
  mutate(current_constitution = NULL, state_number = NULL) %>% #excluindo colunas
  arrange(desc(numero_total_constituicoes)) #ordenando a tabela
```


### Gráfico 4 - Número de Constituições por cada estado estadunidense ####
A fim de identificar a quantidade de constituições totais que cada estado da Federação teve e verificar a propensão a mudanças constitucionais a partir desse valor, criamos o Gráfico 4.

```{r, fig.height=6, fig.width=8, echo=FALSE, warning=FALSE, message = FALSE}
#Criando gráfico com informações sobre o número de Constituições de cada estado
const_eua_painel$constitution_year <- as.factor(const_eua_painel$constitution_year)
 
const_eua_painel %>%
  select(abbreviation, numero_total_constituicoes, constitution_year) %>% 
  ggplot(aes(x = numero_total_constituicoes, 
             y = fct_inorder(abbreviation),
             fill = constitution_year)) + #ao definir o mapping no ggplot, as orientações são globais para todos os outros gráficos que virem a seguir
  geom_col(alpha = 0.7, width = .65) + 
  scale_x_continuous(breaks = seq(0,12, 2)) +
  scale_fill_brewer(palette = "Paired") +
  labs(x = "Número de Constituições",
       y = "Estado") +
  theme_minimal()

```


A partir do Gráfico percebemos que Los Angeles é o Estado com o maior número de constituições, enquanto diversos outros estados apresentam apenas duas mudanças constitucionais. São eles: Alaska, Arizona, Colorado, Hawaii, Idaho, Kansas, Maine, Massachusetts, Minnesota, Nevada, New Mexico, North Dakota, Oklahoma, Oregon, South Dakota, Utah, Wisconsin, Wyoming. 

Enquanto a Califórnia figura como o estado com o maior desvio padrão entre as médias observadas nas estados, o mesmo não se observa no quantitativo das mudanças constitucionais. O estado tem uma posição mediana, mudando suas normas constitucionais apenas 4 vezes. 


```{r paged.print=TRUE, echo=FALSE, message = FALSE}
const_eua_painel %>% filter(numero_total_constituicoes ==2)
```

### Gráfico 5 - Relação entre número de Constituições por estado e data de criação do estado ####
Diante dos dados sobre o total de constituições que cada estado promulgou, objetivamos identificar se há alguma relação entre a criação do estado e o número de constituições promulgadas, isto é, se a data de criação do estado também influencia em sua propensão à mudança constitucional. Para isso criaremos um gráfico de pontos, pois o objetivo é ver a relação entre duas variáveis.

```{r, fig.height=6, fig.width=8, echo=FALSE, warning=FALSE, message = FALSE}
const_eua_painel %>% 
  ggplot(aes(x=statehood, y= numero_total_constituicoes)) + #definindo os dados a serem projetados nos eixos x e y e ordenamento a partir do eixo y
  geom_point(color="red", size=1, fill="red") +#definindo a geometria scatter com cor de contorno e preenchimento vermelhas e o tamanho do preenchimento
 geom_text(aes(label=abbreviation), colour = "black", size = 3, vjust = 1.5, position = position_dodge(.9), check_overlap = TRUE)+ #etiquetando o estado para cada ponto no gráfico e usando check_overlap para que nenhuma etiqueta se sobreponha
  labs(x = "Data de criação do estado",
       y = "Número de Constituições") +
  theme_classic()  #definindo o tema classico
```



Dada a dispersão entre os pontos do gráfico, não foi possível notar relação entre a data de criação do estado e a propensão a mudança constitucional pela análise da quantidade total de constituições promulgadas. 

### Gráfico 6 - Correlação entre o número de constituições e a data de criação do estado
Este gráfico foi elaborado com o objetivo de medir a correlação entre o número de constituições que cada estado já teve aprovada e a data de criação do Estado. A partir desses dados será possível inferir se há correlação entre essas duas variáveis - número de constituições e data de criação do estado, ou seja, se estados mais antigos são mais propensos a romoverem mudanças constitucionais.

```{r, fig.height=6, fig.width=6, echo=FALSE, warning=FALSE, message = FALSE}
state_const %>% 
  add_count(state) %>%
  filter(current_constitution == 1) %>% 
  ggscatter(x = "n", 
            y = "statehood", 
            add = "reg.line", # Adicionando linha de regressão
            conf.int = TRUE) + 
  stat_cor(aes(), method = "pearson", label.x = 2) + # Adicionando correlação
   labs(x = "Número de Constituições",
       y = "Data de criação do estado") 
```
Dada a dispersão do gráfico e como o p-valor é menor do que 0,05, é possível descartar a hipótese de que quanto mais antiga a data de criação do estado mais propenso ele é a promover mudanças constitucionais. 

## Análise das mudanças constitucionais a partir do Índice de Mudança Proporcional dos Poderes ####

O objetivo desta subseção é fazer uma exploração dos dados a partir de três variáveis: **Lesislative**, **Executive**, e **Judicial**. Para explorar essa relação criamos o Índice de Mudança Proporcional dos Poderes:


$$
imp_e = executive/powers
$$


$$
imp_l = legislative/powers
$$


$$
imp_j = judicial/powers
$$

ONDE:

- IMP = Índice de Mudança Proporcional dos Poderes
- imp_e = Índice de Mudança Proporcional do Poder Executivo
- imp_l = Índice de Mudança Proporcional do Poder Legislativo
- imp_j = Índice de Mudança Proporcional do Poder Judiciário
- executive, legislative e judicial = quantidade de palavras destinada respectivamente às categorias "Executive", "Legislative" e "Judicial" em cada Constituição
- powers = somatório das palavras destinadas aos três poderes - Executivo + Legislativo + Judiciário - em cada Constituição

Este índice fornece a medida de porporção de cada um dos poderes em relação ao total dedicado aos três em cada Constituição adotada ou emendada pelos 50 estados. Deste modo, espera-se observar se existe proporcionalidade entre eles, ou seja, se há um equilíbrio, necessário ao mecanismo de Checks and Balances, ou se a presença (aqui entendida como o número de palavras dedicadas a eles) de cada um dos poderes nas constituições foi se alterando ao longo do tempo de forma desigual.


```{r, echo=FALSE, message = FALSE, warning=FALSE}
#Manipulando os dados: criando tabela com os índices
constituicoes_poderes <- state_const %>% 
  ##criando um novo data frame com as manipulações
  select(state, constitution_year,current_constitution, 
         total_words, legislative, executive, judicial, abbreviation) %>% ##selecionando as variáveis de interesse
   mutate (poderes = (legislative + executive + judicial), ##criando uma nova coluna com os valores somados das categorias executivo, legislativo e judiciário
          imp_l = (legislative/poderes), 
##criando o índice de mudança proporcional do legislativo em relação à soma dos poderes
          imp_e = (executive/poderes), 
##criando o índice de mudança proporcional do executivo em relação à soma dos poderes
          imp_j = (judicial/poderes)) 
##criando o índice de mudança proporcional do judiciário em relação à soma dos poderes
```


### Gráfico 7 - Relação entre os poderes e as constituições promulgadas por estado ####
A fim de identificarmos a relação entre a quantidade de palavras em cada Constituição referente aos poderes e o ano de promulgação das constituições, elaboramos o gráfico 7.
```{r,  fig.height=5, fig.width=8, echo=FALSE, warning=FALSE, message = FALSE}
constituicoes_poderes %>%
  ggplot(aes(x = constitution_year,
             y = poderes)) + #determinando os eixos x e y
  geom_point(aes(color = abbreviation)) + 
  #determinando a cor por abreviacao/estado
  labs(x = "Ano de promulgação da Constituição",
       y = "Poderes") +
  theme_classic() #deixando clean
```



A partir do gráfico é possível identificar que há uma tendência a aumentar o número de regras formais voltadas aos três poderes ao longo do tempo.

### Gráfico 8 - Indices por ano constitucional e estado ####
Com o objetivo de identificar a relação entre o valor de cada um dos índices de mudança proporcional por estado e ano de promulgação da Constituição foi criado o gráfico 8. A partir dessa análise será possível compreender a evolução ao longo do tempo da participação de cada um dos poderes na Constituição em termos de palavras.

```{r echo=FALSE, fig.height=5, fig.width=9, paged.print=TRUE, warning=FALSE, message = FALSE}
constituicoes_poderes_grafico5 <- constituicoes_poderes %>% 
select(constitution_year, abbreviation, imp_l, imp_e, imp_j) %>% #selecionando as variáveis de interesse
  pivot_longer(cols=3:5, names_to = "indices", values_to = "valores") 
#pivotando os dados para poder plotar os 3 indices

library(viridis) #baixando o pacote virdis para utilizar paleta de cores

constituicoes_poderes_grafico5 %>%ggplot(aes(x= constitution_year, y= valores, group=indices, color=indices)) + 
#determinando eixos x, y e as linhas do grafico para cada um dos indices
  geom_line() + #ordenando as observações a partir do eixo x
  geom_point() + 
#inserindo pontos nas linhas do gráfico apra marcar as mudanças
  facet_wrap(~ abbreviation) + 
#separando por estado
  scale_color_viridis(discrete = TRUE, begin=0, end=0.8) + 
# definindo escala de cores das linhas dos gráficos e ajustando com begin e end para que a paleta de cores fiquem mais fortes e menos suaves
  scale_y_continuous(breaks = c(0.00, 0.40, 0.80)) + 
#definindo as escalas do eixo y
    theme_classic() + 
#tema clássico para ficar mais clean
    labs(y = "Valores dos indices", x="Ano da Constituição") +
     theme(axis.text.x = element_text(size = 6, angle=90, hjust=1), 
#rotacionando o eixo x para melhorar a visualização das datas
        axis.text.y = element_text(size = 6),
        axis.title.x = element_text(size = 10),
        axis.title.y = element_text(size = 10)) 
#determinando o tamanho das fontes dos labels
```



Analisando o gráfico é possível identificar tendência a crescimento da participação constitucional dos poderes no tangente à quantidade de palavras referentes a eles.

### Gráfico 9 - Poderes pelo ano da Constituição ####
Por fim, analisamos se o total de palavras referentes aos três poderes cresceu ao longo do tempo.
```{r fig.height=5, fig.width=9, paged.print=TRUE, echo=FALSE, warning=FALSE, message = FALSE}
constituicoes_poderes %>%
  ggplot(aes(constitution_year, poderes)) + #selecionando os eixos ano da constituicao e da variavel de interesse (poderes)
  geom_line(color = "steelblue", size = 1) + #determinando a cor e tamanho da linha
  geom_point(color = "steelblue") + #determinando a cor do ponto
  labs(y = "Poderes", x="Ano da Constituição") +  #determinando os labels
  facet_wrap(~ abbreviation) + #separando por estado
  scale_y_continuous(breaks = c(0, 7500, 15000)) + #definindo as escalas do eixo y 
  theme_classic() +
     theme(axis.text.x = element_text(size = 6, angle=90, hjust=1), #rotacionando o eixo x para melhorar a visualização das datas
        axis.text.y = element_text(size = 6),
        axis.title.x = element_text(size = 10),
        axis.title.y = element_text(size = 10)) #definindo o tamanho das fontes dos textos dos eixos
```



A partir do gráfico é possível identificar uma tendência a crescimento do número de palavras que pautam regras formais para os três Poderes.

### TESTE DE CONFIANÇA - Alpha de Cronbach a partir dos IMPs ####

Elaboramos o teste de confiança pelo Alpha de Cronbach a fim de identificar se as variáveis relativas aos Índices de Mudança Proporcional estão bem relacionadas.
```{r, echo=FALSE, warning=FALSE, message = FALSE}
library(psych) #baixando o pacote psych

 tabela_para_alpha <- constituicoes_poderes %>% 
#criando um novo dataframe 
  select(imp_l, imp_e, imp_j) 
#selecionando as variáveis de interesse para medir a covariancia 
```

```{r echo=FALSE, paged.print=TRUE, warning=FALSE, message = FALSE}
psych::alpha(tabela_para_alpha, check.keys = TRUE) 
#aplicando a função "alpha" do pacote psych 
##(os dois pontos :: demonstram para o R qual é o pacote a retirar a função)
```

```{r message=TRUE, paged.print=TRUE, echo=FALSE, warning=FALSE, message = FALSE}
alpha1 <- psych::alpha(tabela_para_alpha, check.keys = TRUE)
```

O alpha de interesse é o demonstrado na seção "Reliability analysis" no valor disposto no "raw_alpha". O valor obtido na mensuração é de 0.83. O coficiente Alpha de Cronbach varia entre 0 e 1. Quanto mais próximo de 1, maior consistência interna o índice apresenta. Com o valor obtido, é possível verificar que o grau de consistência interna é bom. Ou seja, é boa a relação entre as variáveis relativas aos Três Poderes. 

# Conclusões ####

- A partir das análises, identificamos que:
1. A variação temporal e o número total de palavras influenciam nas mudanças constitucionais na medida em que, como observado, a quantidade de palavras nas constituições tende a crescer ao longo do tempo.
2. O Alabama é um outlier na medida em que dispõe de um total de palavras absurdamente maior do que qualquer outro estado.
3. Los Angeles é o estado mais propenso a mudanças constitucionais, a partir do histórico da quantidade de constituições já elaboradas no Estado. Por outro lado, temos 18 Estados que tiveram apenas duas constituições, apresentando menor propensão a mudança constitucional.
4. O ano de criação do estado aparenta não influenciar na propensão a mudança constitucional.
5. Há uma tendência de crescimento da regulamentação dos três poderes na medida em que tanto os índices de mudança proporcional dos poderes quanto o total de palavras abordando o assunto evidenciam essa mudança.

- Ademais, identificamos que as variáveis relativas aos três poderes estão bem relacionadas, fortalecendo a hipótese de que há uma tendência ao aumento de regras formais por meio das constituições voltadas aos Três Poderes.

- Observamos, ainda, a comprovação da hipótese alternativa na medida em que o teste T indica diferença estatisticamente significativa.

- Destacamos, ainda, a necessidade de análise qualitativa dos dados, pois eles foram estruturados de forma a aglomerar elementos que poderiam ser interessantes para comparação. Um exemplo é a variável discriminação, que abarca tanto regras formais que combatem qualquer tipo de discriminação, seja ela racial, de gênero, de sexualidade, etc., quanto leis voltadas a reforças segregações. Sendo assim, a estruturação dos dados dificulta a elaboração de inferências.

- Por fim, sugerimos para estudos futuros o aprofundamento da análise qualitativa ao ponto em que é preciso englobar, para além da quantidade de número de palavras, outros aspectos institucionais, legais e sociais que permitam melhor compreender o processo de mudança constitucional nos 50 estados.

# Referências

BRYCE, V.J. *The American Commonwealth: with an induction by G.L. McDowell*, 2 vols. Indianapolis, IL: Liberty Fund, 1995.

BURGESS, Michael D.; TARR, G. Alan; MARKO, Josef (Ed.). *Constitutional dynamics in federal systems: sub-national perspectives*. Montreal: McGill-Queen’s University Press, 2012.

CLOUSE, Julia Gervaise-Rubicam. *Converting the Texts of the US State Constitutions into Quantifiable Data: A Text Analytics Project*. 2019. Tese de Doutorado. George Mason University.

DEALEY, J.Q. *Growth of American State Constitutions: From 1776 to the End of the Year 1914*. Ithaca, NY: Cornell University Library, 2009.

DE GRAZIA, A. *State constitutions: Are they growing longer*. State Government, 26(4), 82-83, 1954.

LUCE, R. *Legislative Principles: The History and Theory Behind Lawmaking by Representative Government*. Clark, NJ: The Lawbook Exchange, Ltd, 2009.

STURM, A.L. The development of state constitutions. Publius, 12(1), *State
constitutional design in federal systems*, 57-98, 1982.

TARR, G. Alan. Explaining state constitutional changes. *Revista de Investigações Constitucionais*, v. 3, n. 2, p. 9-32, 2016.

WOODWARD-BURNS, Robinson. *American Reconstitution: How The States Stabilize American Constitutional Development*. 2017.
